<div class="wizard-pf-contents adjust-size no-margin-bottom">
  <h1 class="control-label centered" for="textInput-markup">
    {{'Inventory' | translate}}
  </h1>
  <div class="container-fluid margin-top-lg">
    <div ng-show="phones.length == 0" class="blank-slate-pf">
      <div class="blank-slate-pf-icon">
        <span class="pficon pficon pficon-add-circle-o"></span>
      </div>
      <h1>
        {{'No phone in inventory' | translate}}
      </h1>
      <p>
        {{'add_phones_empty_state' | translate}}
      </p>
      <div class="blank-slate-pf-main-action">
        <button class="btn btn-primary btn-lg wizard-pf-open wizard-pf-add-phone"
          ng-click="showAddPhonesModal()">{{'Add phones' | translate}}</button>
      </div>
    </div>
    <div ng-show="phones.length != 0">
      <!-- filter phone list -->
      <form role="form" class="search-pf has-button">
        <div class="form-group">
          <div class="search-pf-input-group">
            <input ng-model="searchPhoneString" type="text" class="form-control input-lg"
              placeholder="{{ 'Search' | translate }}..."></input>
          </div>
        </div>
        <div class="form-group">
          <button class="btn btn-default btn-lg" type="submit">
            <span class="fa fa-search"></span>
          </button>
        </div>
      </form>
      <!-- add phones button -->
      <div class="form-group config-row-button">
        <button class="btn btn-lg btn-primary" ng-click="showAddPhonesModal()">{{'Add phones' | translate}}</button>
      </div>
      <!-- phone list -->
      <div class="list-group list-view-pf clear">
        <div class="list-group-item cursor-default"
          ng-repeat="phone in phones | filter:searchPhoneString | orderBy: 'display_name'">
          <div class="list-view-pf-actions">
            <!-- delete phone -->
            <button type="button" class="btn btn-danger" ng-click="showDeletePhoneModal(phone)" data-toggle="modal"
              data-target="#deletePhoneModal">
              {{ 'Delete' | translate }}
            </button>
          </div>
          <div class="list-view-pf-main-info">
            <div class="list-view-pf-left">
              <span class="fa fa-phone list-view-pf-icon-sm {{phone.model ? '' : 'disabled'}}"></span>
            </div>
            <div class="list-view-pf-body">
              <div class="list-view-pf-description">
                <div class="list-group-item-heading {{phone.model ? '' : 'disabled'}}">
                  {{ phone.display_name ? phone.display_name : '-'}}
                </div>
                <div class="list-group-item-text">
                  <select pf-select="{ noneSelectedText: '-' }" ng-change="setPhoneModel(phone)"
                    ng-model="phone.modelObj"
                    ng-options="model.display_name for model in filteredModels(phone.mac) | orderBy:orderByValue">
                    <option value="">-</option>
                  </select>
                </div>
              </div>
              <div class="list-view-pf-additional-info config-info {{phone.model ? '' : 'disabled'}}">
                <div>MAC: <b>{{phone.mac}}</b></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- network scan in progress -->
    <div ng-show="networkScans > 0" class="toast-pf toast-pf-top-right alert alert-info">
      <span class="pficon pficon-info"></span>
      <span class="spinner spinner-sm spinner-notification"></span>
      {{ 'Scanning network for phones' | translate }}...
    </div>

    <!-- network scan completed -->
    <div ng-show="networkScanCompleted && networkScans < 1" class="toast-pf toast-pf-top-right alert alert-success">
      <span class="pficon pficon-ok"></span>
      {{ 'Network scan successfully completed' | translate }}
    </div>

    <!-- add phones modal -->
    <div class="modal" id="add-phone" tabindex="-1" role="dialog">
      <div class="modal-dialog modal-lg wizard-pf modal-wizard">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true" aria-label="Close">
              <span class="pficon pficon-close"></span>
            </button>
            <h4 class="modal-title">{{'Add phones' | translate}}</h4>
          </div>
          <div class="modal-body wizard-pf-body clearfix center-v width-100p">
            <div class="wizard-pf-main mg-left-0">
              <!-- step 1 -->
              <div ng-show="addPhonesStep == 1" class="wizard-pf-contents">
                <div class="blank-slate-pf-main-action row card-row">
                  <div class="card-pf option-card width-33p"
                    ng-class="{ 'active-choose-green': addPhonesType === 'scan' }" ng-click="setAddPhonesType('scan')">
                    <div class="blank-slate-pf no-pad margin-top-md white-background">
                      <div class="blank-slate-pf-icon small-size-wizard">
                        <span class="pficon pficon-network"></span>
                      </div>
                      <h3>{{ 'Scan a network' | translate }}</h3>
                    </div>
                  </div>
                  <div class="card-pf option-card width-33p"
                    ng-class="{ 'active-choose-green': addPhonesType === 'paste' }"
                    ng-click="setAddPhonesType('paste')">
                    <div class="blank-slate-pf no-pad margin-top-md white-background">
                      <div class="blank-slate-pf-icon small-size-wizard">
                        <span class="fa fa-paste"></span>
                      </div>
                      <h3>{{ 'Paste a list of MAC addresses' | translate }}</h3>
                    </div>
                  </div>
                  <div class="card-pf option-card width-33p"
                    ng-class="{ 'active-choose-green': addPhonesType === 'manual' }"
                    ng-click="setAddPhonesType('manual')">
                    <div class="blank-slate-pf no-pad margin-top-md white-background">
                      <div class="blank-slate-pf-icon small-size-wizard">
                        <span class="pficon pficon-edit"></span>
                      </div>
                      <h3>{{ 'Add phones manually' | translate }}</h3>
                    </div>
                  </div>
                </div>
              </div>
              <!-- step 2 - manual -->
              <div ng-show="addPhonesStep == 2 && addPhonesType === 'manual'" class="wizard-pf-contents">
                <form class="form-horizontal" ng-submit="addPhonesManual()">
                  <div class="form-group" ng-class="{ 'has-error': showManualMacError }">
                    <label class="col-sm-4 control-label" for="manual-mac">{{ 'MAC address' | translate }}</label>
                    <div class="col-sm-8">
                      <input type="text" id="manual-mac" name="manualMac" class="form-control" ng-model="manualMac"
                        ng-change="inputMacManualChanged()" maxlength="17">
                      <span ng-show="showManualMacError"
                        class="help-block">{{ 'Enter a valid MAC address' | translate }}</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-4 control-label" for="manual-model">{{ 'Model' | translate }}</label>
                    <div class="col-sm-8">
                      <select class="form-control" pf-select="{ noneSelectedText: '-' }" ng-model="manualModel"
                        ng-options="model.display_name for model in manualFilteredModels | orderBy:orderByValue"
                        id="manual-model">
                        <option value="">-</option>
                      </select>
                    </div>
                  </div>
                  <!-- add phone button -->
                  <div class="form-group">
                    <label class="col-sm-4 control-label"></label>
                    <div class="col-sm-8">
                      <button type="submit" class="btn btn-primary wizard-pf-next">
                        <span class="wizard-pf-button-text">
                          {{ 'Add phone' | translate }}
                        </span>
                      </button>
                    </div>
                  </div>
                </form>
              </div>
              <!-- step 2 - paste MAC list -->
              <div ng-show="addPhonesStep == 2 && addPhonesType === 'paste'" class="wizard-pf-contents">
                <form class="form-horizontal">
                  <div class="form-group">
                    <!-- paste textarea -->
                    <label class="col-sm-3 control-label" for="paste-textarea">
                      {{ 'Copy a list of MAC addresses and paste it here' | translate }}
                    </label>
                    <div class="col-sm-9">
                      <textarea id="paste-textarea" class="form-control pasted-mac-area" ng-model="pastedMacsText"
                        ng-change="parsePastedMacs()"></textarea>
                    </div>
                  </div>
                  <div class="pasted-macs">
                    <div class="list-group list-view-pf clear">
                      <div class="list-group-item cursor-default form-group no-margin-left-right"
                        ng-class="{ 'has-error': showPasteMacError[$index], 'border-top-list': $index == 0 }"
                        ng-repeat="mac in pastedMacs track by $index">
                        <div class="list-view-pf-actions">
                          <!-- delete pasted MAC -->
                          <button type="button" class="btn btn-danger" ng-click="deletePastedMac($index)">
                            {{ 'Delete' | translate }}
                          </button>
                        </div>
                        <div class="list-view-pf-main-info">
                          <div class="list-view-pf-left">
                            <span
                              class="fa fa-phone list-view-pf-icon-sm {{pastedModels[$index] ? '' : 'disabled'}}"></span>
                          </div>
                          <div class="list-view-pf-body">
                            <div class="list-view-pf-description">
                              <div class="list-group-item-heading {{pastedModels[$index] ? '' : 'disabled'}}">
                                <!-- MAC -->
                                <input type="text" id="paste-mac-{{$index}}" name="pasteMac{{$index}}"
                                  class="form-control" ng-model="pastedMacs[$index]"
                                  ng-change="inputMacPasteChanged({{$index}})" maxlength="17">
                                <span ng-show="showPasteMacError[$index]"
                                  class="help-block">{{ 'Enter a valid MAC address' | translate }}</span>
                              </div>
                              <div class="list-group-item-text">
                                <!-- model -->
                                <select class="form-control border-color-bbb" pf-select="{ noneSelectedText: '-' }"
                                  ng-model="pastedModels[$index]"
                                  ng-options="model.display_name for model in pasteFilteredModels[$index] | orderBy:orderByValue"
                                  id="paste-model-{{$index}}">
                                  <option value="">-</option>
                                </select>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <!-- step 2 - scan networks -->
              <div ng-show="addPhonesStep == 2 && addPhonesType === 'scan'" class="wizard-pf-contents">
                <form class="form-horizontal" ng-submit="addPhonesManual()">
                  <div class="form-group"
                    ng-class="{ 'has-error': showSelectNetworkToScanError || showNetworkScanInProgressError }">
                    <label class="col-sm-4 control-label" for="manual-model">{{ 'Network to scan' | translate }}</label>
                    <div class="col-sm-8">
                      <select class="form-control" pf-select="{ noneSelectedText: '-' }" ng-model="networkToScan"
                        ng-options="network as (network.name + ' | ' + network.network) for network in networks | orderBy:orderByValue"
                        ng-change="networkToScanChanged()">
                        <option value="">-</option>
                      </select>
                      <span ng-show="showSelectNetworkToScanError"
                        class="help-block">{{ 'Select a network' | translate }}</span>
                      <span ng-show="showNetworkScanInProgressError"
                        class="help-block">{{ 'This network is already being scanned' | translate }}</span>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-sm-4 control-label" for="manual-model">{{ 'IP Address' | translate }}</label>
                    <div class="col-sm-8">
                      <input ng-model="networkToScan.ip" type="text" class="form-control" disabled></input>
                      <span ng-show="showNetmaskToScanError"
                        class="help-block">{{ 'Enter a valid netmask' | translate }}</span>
                    </div>
                  </div>
                  <div class="form-group" ng-class="{ 'has-error': showNetmaskToScanError }">
                    <label class="col-sm-4 control-label" for="manual-model">{{ 'Netmask' | translate }}</label>
                    <div class="col-sm-8">
                      <input ng-model="networkToScan.netmask" type="text" class="form-control"
                        ng-change="netmaskToScanChanged()"></input>
                      <span ng-show="showNetmaskToScanError"
                        class="help-block">{{ 'Enter a valid netmask' | translate }}</span>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>
          <div class="modal-footer wizard-pf-footer modal-wizard-footer">
            <!-- next button -->
            <button type="submit" class="btn btn-primary wizard-pf-next" ng-show="addPhonesStep < addPhonesTotalSteps"
              ng-click="addPhonesNextStep()">
              <span class="wizard-pf-button-text">
                {{ 'Next' | translate }}
              </span>
              <span class="i fa fa-angle-right"></span>
            </button>
            <!-- finish button -->
            <button type="button" class="btn btn-primary wizard-pf-next" ng-show="addPhonesStep == addPhonesTotalSteps"
              ng-click="addPhonesFinish()">
              <span class="wizard-pf-button-text">
                {{ 'Finish' | translate }}
              </span>
            </button>
            <!-- back button -->
            <button type="button" class="btn btn-default wizard-pf-back" ng-disabled="addPhonesStep == 1"
              ng-click="addPhonesPreviousStep()">
              <span class="i fa fa-angle-left"></span>
              <span class="wizard-pf-button-text">
                {{ 'Back' | translate }}
              </span>
            </button>
            <!-- cancel -->
            <button type="button" class="btn btn-default btn-cancel wizard-pf-cancel wizard-pf-dismiss"
              ng-click="hideAddPhonesModal()">
              {{ 'Cancel' | translate }}
            </button>
            <button type="button"
              class="btn btn-primary hidden wizard-pf-close wizard-pf-dismiss">{{ 'Close' | translate }}</button>
          </div><!-- /.wizard-pf-footer -->
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->

    <!-- delete phone modal -->
    <div class="modal fade" id="deletePhoneModal" tabindex="-1" role="dialog" aria-labelledby="deletePhoneModal"
      aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
              <span class="pficon pficon-close"></span>
            </button>
            <h4 class="modal-title">
              {{ 'Delete phone' | translate }}
            </h4>
          </div>
          <form class="form-horizontal">
            <div class="modal-body">
              <div class="alert alert-warning alert-dismissable">
                <span class="pficon pficon-warning-triangle-o"></span>
                <span class="margin-left-5">
                  {{ 'You are about to delete phone' | translate }}{{ phoneToDelete.display_name ? ' ' + phoneToDelete.display_name : ''}}
                  {{ phoneToDelete.mac }}
                </span>
              </div>
              <form class="form-horizontal">
                <div class="form-group">
                  <label class="col-sm-3 control-label">
                    {{ 'Are you sure' | translate }}?
                  </label>
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">{{ 'Cancel' | translate }}</button>
              <button type="submit" class="btn btn-danger" ng-click="deletePhone()">
                {{ 'Delete' | translate }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>